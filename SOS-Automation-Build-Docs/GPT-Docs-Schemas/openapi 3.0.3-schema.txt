openapi: 3.0.3
info:
  title: HigherGov API
  version: 1.0.0
  description: Full HigherGov API endpoints for integration with SourceOne RAG.
servers:
  - url: https://www.highergov.com
components:
  securitySchemes:
    ApiKeyAuth:
      type: apiKey
      in: query
      name: api_key
security:
  - ApiKeyAuth: []
paths:
  /api-external/agency/:
    get:
      operationId: api_external_agency_list
      summary: Federal and State and Local Agencies and hierarchies.
      parameters:
        - in: query
          name: agency_key
          schema:
            type: integer
        - in: query
          name: page_number
          schema:
            type: integer
        - in: query
          name: page_size
          schema:
            type: string
            default: '10'
      responses:
        '200':
          description: Success

  /api-external/awardee/:
    get:
      operationId: api_external_awardee_list
      summary: Federal Awardees registered in SAM and DSBS.
      parameters:
        - in: query
          name: awardee_key_parent
          schema:
            type: integer
        - in: query
          name: cage_code
          schema:
            type: string
        - in: query
          name: ordering
          schema:
            type: string
            enum: [-last_update_date, last_update_date]
        - in: query
          name: page_number
          schema:
            type: integer
        - in: query
          name: page_size
          schema:
            type: string
            default: '10'
        - in: query
          name: primary_naics
          schema:
            type: string
        - in: query
          name: registration_last_update_date
          schema:
            type: string
            format: date
        - in: query
          name: uei
          schema:
            type: string
      responses:
        '200':
          description: Success

  /api-external/awardee-mp/:
    get:
      operationId: api_external_awardee_mp_list
      summary: Awardee Mentor-Protege relationships.
      parameters:
        - in: query
          name: awardee_key_mentor
          schema:
            type: integer
        - in: query
          name: awardee_key_mentor_parent
          schema:
            type: integer
        - in: query
          name: awardee_key_protege
          schema:
            type: integer
        - in: query
          name: awardee_key_protege_parent
          schema:
            type: integer
        - in: query
          name: page_number
          schema:
            type: integer
        - in: query
          name: page_size
          schema:
            type: string
            default: '10'
      responses:
        '200':
          description: Success

  /api-external/awardee-partnership/:
    get:
      operationId: api_external_awardee_partnership_list
      summary: Teaming partnerships between different Awardees.
      parameters:
        - in: query
          name: awardee_key_prime
          schema:
            type: integer
        - in: query
          name: awardee_key_prime_parent
          schema:
            type: integer
        - in: query
          name: awardee_key_sub
          schema:
            type: integer
        - in: query
          name: awardee_key_sub_parent
          schema:
            type: integer
        - in: query
          name: page_number
          schema:
            type: integer
        - in: query
          name: page_size
          schema:
            type: string
            default: '10'
      responses:
        '200':
          description: Success

  /api-external/contract/:
    get:
      operationId: api_external_contract_list
      summary: Federal prime contract awards.
      parameters:
        - in: query
          name: award_id
          schema:
            type: string
        - in: query
          name: awardee_key
          schema:
            type: integer
        - in: query
          name: awardee_key_parent
          schema:
            type: integer
        - in: query
          name: awardee_uei
          schema:
            type: string
        - in: query
          name: awardee_uei_parent
          schema:
            type: string
        - in: query
          name: awarding_agency_key
          schema:
            type: integer
        - in: query
          name: funding_agency_key
          schema:
            type: integer
        - in: query
          name: last_modified_date
          schema:
            type: string
            format: date
        - in: query
          name: naics_code
          schema:
            type: string
        - in: query
          name: ordering
          schema:
            type: string
            enum: [-action_date, -current_total_value_of_award, -last_modified_date, -period_of_performance_potential_end_date, -potential_total_value_of_award, -total_dollars_obligated, action_date, current_total_value_of_award, last_modified_date, period_of_performance_potential_end_date, potential_total_value_of_award, total_dollars_obligated]
        - in: query
          name: page_number
          schema:
            type: integer
        - in: query
          name: page_size
          schema:
            type: string
            default: '10'
        - in: query
          name: parent_award_id
          schema:
            type: string
        - in: query
          name: psc_code
          schema:
            type: string
        - in: query
          name: search_id
          schema:
            type: string
        - in: query
          name: vehicle_key
          schema:
            type: integer
      responses:
        '200':
          description: Success

  /api-external/document/:
    get:
      operationId: api_external_document_list
      summary: Returns document paths for downloading documents associated with an opportunity.
      parameters:
        - in: query
          name: ordering
          schema:
            type: string
        - in: query
          name: page_number
          schema:
            type: integer
        - in: query
          name: page_size
          schema:
            type: string
            default: '10'
        - in: query
          name: related_key
          schema:
            type: string
            required: true
      responses:
        '200':
          description: Success

  /api-external/grant/:
    get:
      operationId: api_external_grant_list
      summary: Federal prime grant awards.
      parameters:
        - in: query
          name: awardee_key
          schema:
            type: integer
        - in: query
          name: awardee_key_parent
          schema:
            type: integer
        - in: query
          name: awardee_uei
          schema:
            type: string
        - in: query
          name: awardee_uei_parent
          schema:
            type: string
        - in: query
          name: awarding_agency_key
          schema:
            type: integer
        - in: query
          name: cfda_program_number
          schema:
            type: string
        - in: query
          name: funding_agency_key
          schema:
            type: integer
        - in: query
          name: last_modified_date
          schema:
            type: string
            format: date
        - in: query
          name: ordering
          schema:
            type: string
            enum: [-action_date, -last_modified_date, -total_obligated_amount, action_date, last_modified_date, total_obligated_amount]
        - in: query
          name: page_number
          schema:
            type: integer
        - in: query
          name: page_size
          schema:
            type: string
            default: '10'
        - in: query
          name: search_id
          schema:
            type: string
      responses:
        '200':
          description: Success
  /search:
    get:
      operationId: assessWithRAG
      summary: Assess text using the SourceOne RAG semantic search
      description: >
        Passes a text string to the SourceOne RAG semantic search engine and returns the top semantic matches.
        This endpoint is public and does not require authentication.
      parameters:
        - in: query
          name: query
          required: true
          schema:
            type: string
          description: Text or query to be assessed by the RAG semantic search engine.
      responses:
        '200':
          description: Top semantic matches from the RAG.
          content:
            application/json:
              schema:
                type: object
                properties:
                  results:
                    type: array
                    items:
                      type: object
                      properties:
                        section:
                          type: string
                          description: Section of the knowledge base where the match was found.
                        similarity:
                          type: number
                          description: Similarity score (higher is more similar).
                        text:
                          type: string
                          description: Matched text snippet.

  /workflow/highergov-assess:
    get:
      operationId: highergovAssessWorkflow
      summary: Retrieve HigherGov data from any endpoint and assess with the SourceOne RAG
      description: >
        Allows selecting any HigherGov endpoint, retrieving data (optionally filtered with a search_id),
        and sending the results to the SourceOne RAG for semantic analysis in one call.
      parameters:
        - in: query
          name: endpoint
          required: true
          schema:
            type: string
            enum:
              - agency
              - awardee
              - awardee-mp
              - awardee-partnership
              - contract
              - document
              - grant
              - grant-program
              - idv
              - naics
              - nsn
              - opportunity
              - people
              - psc
              - subcontract
              - subgrant
              - vehicle
          description: >
            The HigherGov endpoint to call (exclude the `/api-external/` prefix).
        - in: query
          name: search_id
          schema:
            type: string
          description: >
            HigherGov search ID to filter results.
        - in: query
          name: page_size
          schema:
            type: integer
            default: 10
          description: Number of records to return from HigherGov.
        - in: query
          name: assess
          schema:
            type: boolean
            default: true
          description: >
            Whether to send the HigherGov results to the SourceOne RAG for analysis.
      responses:
        '200':
          description: Combined HigherGov + RAG results.
          content:
            application/json:
              schema:
                type: object
                properties:
                  highergov_results:
                    type: array
                    description: Raw results from the HigherGov API.
                  rag_results:
                    type: array
                    description: Semantic matches from the SourceOne RAG based on HigherGov data.

